---
layout: post
title: Set SQL Vulnerability assessment failure in Activity log of Azure SQL Server.
categories: SQLDB
description: 
keywords: sqldb, AzureSQL,sql mi,Azure SQL MI,Mananged Instance, idle connection,proxy mode
---

You might see "Set SQL Vulnerability assessment" failure in Activity log of Azure SQL Server. And in the details error, we will see below eror
```json
{
    "status": {
        "value": "Failed",
        "localizedValue": "Failed"
    },
    "subStatus": {
        "value": "Conflict",
        "localizedValue": "Conflict (HTTP Status Code: 409)"
    },
    "statusMessage": "{
        "error": {
            "code": "SqlVulnerabilityAssessmentStoragefullApiIsEnabled",
            "message": "Vulnerability Assessment is enabled on this server or one of its underlying databases with an incompatible version. Additional troubleshooting information can be found https://aka.ms/SQLVAStoragelessDocumentation. "
        }
    }
}
```

This "error" is coming from a background process of Microsoft Defender for Cloud that's verifying the configurations for Express enabled databases. If the resource is on Classic configuration, you get this error. 

Solution: Migrate from Classic configuration to Express configuration at Subscription level.

[SQLVAStoragelessDocumentation](https://aka.ms/SQLVAStoragelessDocumentation) introduced the difference between the express and classic configuration of SQL vulnerability assessment.
